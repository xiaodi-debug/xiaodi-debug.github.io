import{_ as a,q as e,z as l,V as o}from"./chunks/framework.D-E96EZ1.js";const i=JSON.parse('{"title":"在飞牛 NAS 上用 Docker 折腾 CloudSave、quark-auto-save、v2raya","description":"记录我在飞牛 NAS 上用 Docker 部署 CloudSave、quark-auto-save、v2raya、飞牛影视和飞牛图库的过程，以及中间踩过的一些小坑。","frontmatter":{"title":"在飞牛 NAS 上用 Docker 折腾 CloudSave、quark-auto-save、v2raya","tags":["NAS","Docker","自建服务","踩坑记录"],"categories":["NAS"],"date":"2025-12-10T00:00:00.000Z","description":"记录我在飞牛 NAS 上用 Docker 部署 CloudSave、quark-auto-save、v2raya、飞牛影视和飞牛图库的过程，以及中间踩过的一些小坑。","articleGPT":"这是一篇 NAS 折腾记录，主要围绕在飞牛 NAS 上通过 Docker 部署 CloudSave、quark-auto-save、v2raya、飞牛影视和飞牛图库，顺带整理一下网络、端口、持久化卷以及自动化的注意事项。","references":[],"cover":"https://gitee.com/its-liu-xiaodi_admin/my_img/raw/image/docker.png","head":[["link",{"rel":"canonical","href":"https://liuxiaodi.icu/posts/2025/nas-docker-feiniu-deploy"}]]},"headers":[],"relativePath":"posts/2025/nas-docker-feiniu-deploy.md","filePath":"posts/2025/nas-docker-feiniu-deploy.md","lastUpdated":1765800244000}');const r=a({name:"posts/2025/nas-docker-feiniu-deploy.md"},[["render",function(a,i,r,s,c,d){return l(),e("div",null,[...i[0]||(i[0]=[o('<h2 id="背景-为什么要在-nas-上折腾这么多服务" tabindex="-1">背景：为什么要在 NAS 上折腾这么多服务？ <a class="header-anchor" href="#背景-为什么要在-nas-上折腾这么多服务" aria-label="Permalink to &quot;背景：为什么要在 NAS 上折腾这么多服务？&quot;">​</a></h2><p>有了 NAS 之后，很自然地会想：</p><ul><li>把各种下载 / 同步的东西<strong>集中管理</strong>；</li><li>一台机器搞定<strong>云盘备份、自动离线下载、科学上网、家庭影音、相册管理</strong>；</li><li>能在外网也比较方便地访问自己的服务。</li></ul><p>于是就有了这一套组合：</p><ul><li>CloudSave：做多云盘之间的同步、备份；</li><li>quark-auto-save：自动把资源存到夸克网盘；</li><li>v2raya：图形化管理代理客户端；</li><li>飞牛影视：家庭流媒体中心；</li><li>飞牛图库：家庭相册 / 图片管理。</li></ul><p>这篇文章主要记录我在飞牛 NAS 上用 Docker 把这些服务跑起来的过程，以及中间踩过的坑，方便以后自己查，也希望能帮到同样在折腾 NAS 的你。</p><hr><h2 id="一、准备工作-docker-环境和基础网络" tabindex="-1">一、准备工作：Docker 环境和基础网络 <a class="header-anchor" href="#一、准备工作-docker-环境和基础网络" aria-label="Permalink to &quot;一、准备工作：Docker 环境和基础网络&quot;">​</a></h2><h3 id="_1-nas-上的-docker-环境" tabindex="-1">1. NAS 上的 Docker 环境 <a class="header-anchor" href="#_1-nas-上的-docker-环境" aria-label="Permalink to &quot;1. NAS 上的 Docker 环境&quot;">​</a></h3><p>我使用的是飞牛 NAS 自带的 Docker 环境，大致确认了几件事情：</p><ul><li>Docker 能正常拉取镜像（国内网络建议配置镜像加速）；</li><li>有一个<strong>专门放配置和数据的共享文件夹</strong>，比如：<code>/volume1/docker-data</code>；</li><li>宿主机的时区、时间已经校准好，不然后面日志和计划任务会很迷惑。</li></ul><p>目录大致规划如下：</p><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/volume1/docker-data</span></span>\n<span class="line"><span>  ├─ cloudsave</span></span>\n<span class="line"><span>  ├─ quark-auto-save</span></span>\n<span class="line"><span>  ├─ v2raya</span></span>\n<span class="line"><span>  ├─ feiniu-movie</span></span>\n<span class="line"><span>  └─ feiniu-gallery</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>踩坑小记：一开始我把配置随便放，结果迁移 / 备份的时候特别痛苦。后来统一约定所有 Docker 容器的数据都进 <code>docker-data</code>，心情愉快很多。</p></blockquote><h3 id="_2-网络和端口规划" tabindex="-1">2. 网络和端口规划 <a class="header-anchor" href="#_2-网络和端口规划" aria-label="Permalink to &quot;2. 网络和端口规划&quot;">​</a></h3><p>在一台 NAS 上跑这么多服务，端口规划非常重要，否则：</p><ul><li>要么冲突启动不了；</li><li>要么记不住哪个服务对应哪个端口。</li></ul><p>我最后的规划类似这样（仅示例）：</p><ul><li>CloudSave：<code>5801</code></li><li>quark-auto-save：<code>5802</code></li><li>v2raya：<code>5803</code></li><li>飞牛影视：<code>5804</code></li><li>飞牛图库：<code>5805</code></li></ul><p>原则：</p><ul><li>统一用一段连续的端口，方便记忆；</li><li>如果有反向代理（比如 nginx / caddy），把这些端口都代理到对应的域名路径下。</li></ul><hr><h2 id="二、cloudsave-统一管理多云盘同步" tabindex="-1">二、CloudSave：统一管理多云盘同步 <a class="header-anchor" href="#二、cloudsave-统一管理多云盘同步" aria-label="Permalink to &quot;二、CloudSave：统一管理多云盘同步&quot;">​</a></h2><h3 id="_1-容器部署思路" tabindex="-1">1. 容器部署思路 <a class="header-anchor" href="#_1-容器部署思路" aria-label="Permalink to &quot;1. 容器部署思路&quot;">​</a></h3><p>CloudSave 的部署比较常规：</p><ul><li>一个 Web 管理界面；</li><li>挂载配置目录，用来保存账号信息、任务配置；</li><li>挂载一个数据目录，作为临时缓存或中转区。</li></ul><p>在飞牛 NAS 的 Docker 界面里创建容器时，注意：</p><ul><li>映射端口：宿主 <code>5801</code> → 容器内部 Web 端口；</li><li>映射卷： <ul><li>配置：<code>/volume1/docker-data/cloudsave/config</code> → <code>/app/config</code></li><li>数据：<code>/volume1/docker-data/cloudsave/data</code> → <code>/app/data</code></li></ul></li></ul><h3 id="_2-登录云盘和任务配置" tabindex="-1">2. 登录云盘和任务配置 <a class="header-anchor" href="#_2-登录云盘和任务配置" aria-label="Permalink to &quot;2. 登录云盘和任务配置&quot;">​</a></h3><p>部署好之后，访问：</p><ul><li><code>http://NAS-IP:5801</code></li></ul><p>主要做几件事情：</p><ul><li>添加各个云盘账号（阿里云盘 / 夸克 / OneDrive 等）；</li><li>为常用的目录建<strong>同步任务</strong>，比如： <ul><li>本地某个备份目录 → 阿里云盘；</li><li>本地某个媒体目录 → 另一块盘。</li></ul></li></ul><blockquote><p>踩坑：有的云盘登录需要扫码或 Cookies，有有效期的，建议定期检查一下，防止任务长期失败却没发现。</p></blockquote><hr><h2 id="三、quark-auto-save-自动把资源存到夸克" tabindex="-1">三、quark-auto-save：自动把资源存到夸克 <a class="header-anchor" href="#三、quark-auto-save-自动把资源存到夸克" aria-label="Permalink to &quot;三、quark-auto-save：自动把资源存到夸克&quot;">​</a></h2><p>有了 CloudSave 之后，我还想解决一个痛点：</p><blockquote><p>某些资源分享链接想第一时间保存到夸克网盘，但又不想每次手动点“保存”。</p></blockquote><p>于是就用上了 quark-auto-save。</p><h3 id="_1-部署要点" tabindex="-1">1. 部署要点 <a class="header-anchor" href="#_1-部署要点" aria-label="Permalink to &quot;1. 部署要点&quot;">​</a></h3><p>这里同样是在 Docker 里拉镜像，注意：</p><ul><li>端口映射：宿主 <code>5802</code> → 容器 Web 端口；</li><li>配置目录：<code>/volume1/docker-data/quark-auto-save/config</code> → <code>/app/config</code>；</li><li>如果有需要，也可以挂载一个日志目录方便排查问题。</li></ul><h3 id="_2-夸克登录与自动任务" tabindex="-1">2. 夸克登录与自动任务 <a class="header-anchor" href="#_2-夸克登录与自动任务" aria-label="Permalink to &quot;2. 夸克登录与自动任务&quot;">​</a></h3><p>启动后访问：<code>http://NAS-IP:5802</code>，大致流程：</p><ul><li>登录夸克账号（通常是扫码 / Cookie）；</li><li>配置一个或多个<strong>监控任务</strong>： <ul><li>比如定期去某个 RSS / 订阅源抓取链接；</li><li>或者提供一个接口，外部脚本调用，让它自动保存。</li></ul></li></ul><blockquote><p>踩坑：如果你把 quark-auto-save 暴露到公网，一定记得加上鉴权（反代加 BasicAuth 或者 IP 限制），否则别人也能帮你“自动存东西”。</p></blockquote><hr><h2 id="四、v2raya-代理客户端的图形管理" tabindex="-1">四、v2raya：代理客户端的图形管理 <a class="header-anchor" href="#四、v2raya-代理客户端的图形管理" aria-label="Permalink to &quot;四、v2raya：代理客户端的图形管理&quot;">​</a></h2><p>v2raya 的好处是：</p><ul><li>有 Web 界面，方便在 NAS 上集中管理多个节点；</li><li>可以配合 NAS 的路由 / 容器网络，实现“某些服务走代理、某些直连”。</li></ul><h3 id="_1-容器部署" tabindex="-1">1. 容器部署 <a class="header-anchor" href="#_1-容器部署" aria-label="Permalink to &quot;1. 容器部署&quot;">​</a></h3><p>仍然是在 Docker 中创建容器：</p><ul><li>端口映射：宿主 <code>5803</code> → v2raya Web 管理端口；</li><li>配置目录：<code>/volume1/docker-data/v2raya</code> → <code>/etc/v2raya</code>；</li><li>视乎你的网络环境，是否需要： <ul><li><code>NET_ADMIN</code> 权限；</li><li>加入特定的 Docker 网络（比如与需要代理的容器放在同一个自定义网络里）。</li></ul></li></ul><h3 id="_2-使用体验与注意点" tabindex="-1">2. 使用体验与注意点 <a class="header-anchor" href="#_2-使用体验与注意点" aria-label="Permalink to &quot;2. 使用体验与注意点&quot;">​</a></h3><ul><li>在 Web UI 中导入节点（订阅 / 手动）；</li><li>可以单独为某些容器配置“走 v2raya 网络”；</li><li>注意不要把 NAS 自己的管理端口全部代理出去了，否则排错会很痛苦。</li></ul><blockquote><p>小建议：刚开始可以只让某个测试容器走 v2raya，看一切正常再大范围使用。</p></blockquote><hr><h2 id="五、飞牛影视-飞牛图库-家庭娱乐中心" tabindex="-1">五、飞牛影视 &amp; 飞牛图库：家庭娱乐中心 <a class="header-anchor" href="#五、飞牛影视-飞牛图库-家庭娱乐中心" aria-label="Permalink to &quot;五、飞牛影视 &amp; 飞牛图库：家庭娱乐中心&quot;">​</a></h2><p>这两个算是飞牛生态里的“重头戏”：</p><ul><li>飞牛影视：类似家庭版流媒体中心；</li><li>飞牛图库：家庭照片 / 图片管理系统。</li></ul><h3 id="_1-目录结构规划" tabindex="-1">1. 目录结构规划 <a class="header-anchor" href="#_1-目录结构规划" aria-label="Permalink to &quot;1. 目录结构规划&quot;">​</a></h3><p>为了让它们都能读到统一的数据，我在 NAS 上做了这样一个结构：</p><div class="language-text vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/volume1/media</span></span>\n<span class="line"><span>  ├─ movies      # 电影</span></span>\n<span class="line"><span>  ├─ tv          # 电视剧 / 综艺</span></span>\n<span class="line"><span>  └─ photos      # 照片 / 图库</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在 Docker 里：</p><ul><li>飞牛影视挂载 <code>/volume1/media/movies</code>、<code>/volume1/media/tv</code> 到容器内部对应目录；</li><li>飞牛图库挂载 <code>/volume1/media/photos</code>。</li></ul><h3 id="_2-docker-容器配置要点" tabindex="-1">2. Docker 容器配置要点 <a class="header-anchor" href="#_2-docker-容器配置要点" aria-label="Permalink to &quot;2. Docker 容器配置要点&quot;">​</a></h3><p>飞牛影视：</p><ul><li>端口：宿主 <code>5804</code> → 容器 Web 端口；</li><li>配置：<code>/volume1/docker-data/feiniu-movie/config</code> → <code>/app/config</code>；</li><li>媒体库：<code>/volume1/media</code> → <code>/media</code>。</li></ul><p>飞牛图库：</p><ul><li>端口：宿主 <code>5805</code> → 容器 Web 端口；</li><li>配置：<code>/volume1/docker-data/feiniu-gallery/config</code> → <code>/app/config</code>；</li><li>照片：<code>/volume1/media/photos</code> → <code>/photos</code>。</li></ul><h3 id="_3-元数据与扫描" tabindex="-1">3. 元数据与扫描 <a class="header-anchor" href="#_3-元数据与扫描" aria-label="Permalink to &quot;3. 元数据与扫描&quot;">​</a></h3><p>部署完成后：</p><ul><li>先在 Web 界面配置媒体库路径；</li><li>再触发一次全量扫描，之后可以改成定时增量扫描。</li></ul><blockquote><p>踩坑：文件名、目录结构尽量规范化，不然自动识别影片 / 剧集信息会经常错； 照片建议按 <code>年份/月份</code> 这样分类，图库加载速度也会更稳定一些。</p></blockquote><hr><h2 id="六、统一访问-反向代理与-https" tabindex="-1">六、统一访问：反向代理与 HTTPS <a class="header-anchor" href="#六、统一访问-反向代理与-https" aria-label="Permalink to &quot;六、统一访问：反向代理与 HTTPS&quot;">​</a></h2><p>当服务越来越多时，端口访问会变得很难记：</p><ul><li><code>5801</code> 是 CloudSave 还是 quark-auto-save？</li><li>家人想看飞牛影视，还得记 <code>5804</code>？</li></ul><p>所以我最后加了一层反代（比如 Nginx / Caddy）：</p><ul><li><code>https://nas.example.com/cloudsave</code> → 内部 <code>http://NAS-IP:5801</code></li><li><code>https://nas.example.com/quark</code> → <code>http://NAS-IP:5802</code></li><li><code>https://nas.example.com/v2</code> → <code>http://NAS-IP:5803</code></li><li><code>https://nas.example.com/movie</code> → <code>http://NAS-IP:5804</code></li><li><code>https://nas.example.com/gallery</code> → <code>http://NAS-IP:5805</code></li></ul><p>并且：</p><ul><li>整体走一个 HTTPS 证书（例如用 Cloudflare / Let7s Encrypt）；</li><li>内网访问时也保持同一套域名，方便配置书签和快捷方式。</li></ul><blockquote><p>建议：对暴露到公网的服务，务必加上登录保护 / IP 白名单，否则风险太大。</p></blockquote><hr><h2 id="七、这一轮-nas-折腾我学到了什么" tabindex="-1">七、这一轮 NAS 折腾我学到了什么？ <a class="header-anchor" href="#七、这一轮-nas-折腾我学到了什么" aria-label="Permalink to &quot;七、这一轮 NAS 折腾我学到了什么？&quot;">​</a></h2><p>最后简单总结一下这次在飞牛 NAS 上用 Docker 折腾这一堆服务的收获：</p><ul><li><p><strong>统一的目录和端口规划很重要</strong><br> 一开始乱七八糟，后面迁移 / 备份、排错都很痛苦。统一用 <code>docker-data</code> + 连续端口之后清爽很多。</p></li><li><p><strong>Docker 容器尽量“无状态”，数据都挂到卷里</strong><br> 以后换 NAS / 换宿主，只要把 <code>docker-compose</code> / 配置和数据卷搬过去，大部分服务可以无痛恢复。</p></li><li><p><strong>针对 NAS 的性能做一点取舍</strong><br> 不要一次性开太多重型服务，尤其是转码、缩略图之类，注意 CPU / 内存 / IO 使用情况。</p></li><li><p><strong>公开服务一定要过一遍安全清单</strong><br> 哪些服务必须外网能访问？哪些只在内网？是否有登录保护？这些问题最好在搭建前就想清楚。</p></li></ul><p>接下来我还打算在 NAS 上继续尝试：</p><ul><li>加一个轻量级监控 / 可视化（比如 Grafana + Prometheus）；</li><li>进一步把 CloudSave、quark-auto-save 和媒体库打通，做一条“从订阅 → 下载 → 整理 → 入库”的自动化流水线。</li></ul><p>如果你也在折腾 NAS，或者对上面的某个服务感兴趣，欢迎在「畅所欲言」页面留言交流，一起把家里的小盒子用出点花来。</p>',90)])])}]]);export{i as __pageData,r as default};
